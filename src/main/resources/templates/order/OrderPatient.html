<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8"/>
    <title>æ‚£è€…ç®¡ç†é é¢</title>
    <!--    æˆ‘çš„font-awesome-->
    <script
            src="https://kit.fontawesome.com/47b671abbd.js"
            crossorigin="anonymous"
    ></script>
    <!--å¼•ç”¨css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.10.3/sweetalert2.css"/>
    <!--å¼•ç”¨SweetAlert2.js-->
    <!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.10.3/sweetalert2.js" type="text/javascript"></script>-->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <style>
        #content {
            /*width: calc(90% - 250px);*/
            margin-left: 350px;
            /* margin-left: calc(20% - 250px); */
            margin-top: 10px;
            padding: 20px;
            /* border: 5px solid red; */
            height: 800px;
        }

        .btnAdd,
        .btnAdd:focus {
            position: relative;
            z-index: 0;
            /*min-width: 200px;*/
            border: 2px solid currentColor;
            border-radius: 48px;
            color: #FF0FF0;
            color: #9d8c56;
            font-size: 1rem;
            text-align: center;
            text-decoration: none;
            overflow: hidden;
            transition: 0.2s transform ease-in-out;
            will-change: transform;
            padding: 10px 20px;
        }

        .btnAdd:after {
            content: '';
            display: block;
            position: absolute;
            height: 100%;
            width: 100%;
            left: 0;
            top: 0;
            z-index: -1;
            background-color: #ff0ff0;
            background-color: #9d8c56;
            border-radius: 3rem;
            transform: translate(-100%, 0) rotate(10deg);
            transform-origin: top left;
            transition: 0.2s transform ease-out;
            will-change: transform;
        }

        .btnAdd:hover:after {
            transform: translate(0, 0);
        }

        .btnAdd:hover {
            border: 2px solid transparent;
            color: #FFFFFF;
            transform: scale(1);
            will-change: transform;
        }

        /*æˆåŠŸæŒ‰éˆ•*/
        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        #successAnimation {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        #confirmButton {
            margin-top: 10px;
            padding: 5px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /*#content {*/
        /*    margin: 0 auto;*/
        /*    padding: 20px;*/
        /*    margin-left: 300px;*/
        /*}*/

        .btn-primary,
        .btn-danger {
            background-color: #007bff; /* Bootstrap é è¨­çš„ä¸»è¦é¡è‰² */
            opacity: 0.9; /* è¨­ç½®é€æ˜åº¦ï¼Œ0.6 è¡¨ç¤º 60% ä¸é€æ˜åº¦ */
        }

        .btn-kai {
            background-color: #3a6ea5;
        }
    </style>
</head>
<body>
<div th:replace="~{display/Model}"></div>
<main>
    <div class="container-fluid col-md-10" id="content">
        <!-- ä¸‹é¢æ˜¯æˆ‘çš„åŠŸèƒ½-->
        <div class="page-inner">
            <div
                    class="card-header col-auto col-10 col-lg-10 mt-3 p-2 rounded border"
                    style="
              margin-top: 2%;
              background-color: #1d3d5e;
              color: #f2f2f1;
              border: 1px solid gray;
            "
            >
                <div class="d-flex align-items-center">
                    <h4 class="card-title playfair-display fs-4 border rounded p-2"
                        style="background-color: #3a6ea5; color: #ffffff;">æ‚£è€…ç®¡ç†</h4>
                    <!--                            class=" btn btn-primary btn-round btn-kai rounded ms-auto"-->
                    <button
                            id="addBtn"
                            class="btnAdd  ms-auto"
                    >
                        <i class="fa-solid fa-square-plus"></i> æ–°å¢æ‚£è€…
                    </button>
                </div>
            </div>
            <!-- æœå°‹å€åŸŸ -->
            <!-- æœå°‹å€åŸŸ -->
            <!-- æœå°‹å€åŸŸ -->
            <div class="row mt-2">
                <div class="col-auto col-10 col-lg-10 p-2 rounded" style="width: 83%;margin-left: 3px">
                    <div class="card" style="background-color: #f2f2f1">
                        <div class="card-body">
                            <!--                            <h5 class="card-title mb-4">æœå°‹è¨‚å–®</h5>-->
                            <div class="row g-3 justify-content-center align-items-center">
                                <!-- é—œéµå­—æœå°‹ -->
                                <div class="col-md-4 ">
                                    <div class="input-group ">
                                        <span class="input-group-text">æœå°‹æ‚£è€… :</span><input type="text" class="form-control " id="Search" placeholder="è¼¸å…¥æ‚£è€…å§“å..." data-searchtype="patientName">
                                        <button class="btn btn-outline-secondary" type="button" id="SearchBtn">
                                            <i class="fa-solid fa-magnifying-glass"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!---------------------------------------------------------------------------------------------------------------------------->
            <!-- ä¸‹é¢æ˜¯è¡¨æ ¼ -->
            <!-- ä¸‹é¢æ˜¯è¡¨æ ¼ -->
            <!-- ä¸‹é¢æ˜¯è¡¨æ ¼ -->
            <div id="" class="row">
                <div class="col-auto col-10 col-lg-10 mt-2">
                    <div class="card" style="background-color: #f2f2f1">
                        <div class="table-responsive">
                            <table
                                    id="patientList"
                                    class="display table table-striped table-hover w-100"
                                    style="padding-bottom: 0;margin-bottom: 0"
                            >
                                <thead>
                                <tr>
                                    <th class="border text-center">æ‚£è€…ç·¨è™Ÿ</th>
                                    <th class="border text-center">å§“å</th>
                                    <th class="border text-center">èº«åˆ†è­‰è™Ÿ</th>
                                    <th class="border text-center">ç”Ÿæ—¥</th>
                                    <th class="border text-center">æ€§åˆ¥</th>
                                    <th class="border text-center">é›»è©±</th>
                                    <th class="border text-center">åœ°å€</th>
                                    <th class="border text-center">ä¿¡ç®±</th>
                                    <th class="border text-center" style="width: 14%">æ“ä½œ</i>
                                    </th>
                                    <!--                                    <th class="border text-center" style="width: 14%"><i class="fa-solid fa-wrench"></i>-->
                                    <!--                                    </th>-->
                                    <!-- <th id="upTime">è¨‚å–®ä¿®æ”¹æ™‚é–“</th> -->
                                </tr>
                                </thead>
                                <tbody id="patientTbody">
                                <!--å¯«ajax  -->

                                <!--å¯«ajax  -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!--                    ä¸‹é¢æ˜¯åˆ†é çš„éƒ¨åˆ†-->

                    <nav aria-label="Page navigation">
                        <ul class="pagination  justify-content-end mt-3 " id="pagination">
                            <li class="page-item " id="prevPage">
                                <a class="page-link" href="#" tabindex="-1">ä¸Šä¸€é </a>
                            </li>
                            <!-- JSå‹•æ…‹æ’å…¥ é æ•¸ -->
                            <!--.............-->
                            <!-- JSå‹•æ…‹æ’å…¥ é æ•¸ -->
                            <li class="page-item" id="nextPage">
                                <a class="page-link" href="#">ä¸‹ä¸€é </a>
                            </li>
                        </ul>
                    </nav>
                    <div class="text-end" id="pageInfo">
<!--                        <input id="pageInfoNow" type="number" class="text-end" style="display: inline">-->
<!--                        <div class="text-end" id="totalPageInfo"></div>-->
                    </div>

                </div>
            </div>
        </div>
    </div>
</main>
</div>
<!--é€™è£é¢æ”¾æˆ‘çš„ Modal -->
<!-- Modal1æ–°å¢æ‚£è€… -->
<div id="addPatientModal" class="modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #1d3d5e">
                <h5 class="modal-title text-light">æ–°å¢æ‚£è€…</h5>
                <button
                        id="addVal"
                        class="btnAdd  ms-auto text-light"
                        style="background: #9d8c56"
                >
                    ä¸€éµå¸¶å…¥
                </button>
                <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                ></button>
            </div>
            <div class="modal-body">
                <form id="PatientForm" action="" method="post">
                    <input type="hidden" name="action" value="add"/>
                    <div class="form-group">
                        <label for="patientName">æ‚£è€…åç¨± :</label>
                        <input
                                id="PatientName"
                                name="patientName"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…å§“å"
                                required
                        />
                    </div>
                    <div class="form-group">
                        <label for="PatientIdCard">èº«åˆ†è­‰è™Ÿç¢¼ :</label>
                        <input
                                id="PatientIdCard"
                                name="idCard"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥èº«åˆ†è­‰è™Ÿç¢¼"
                                required
                        />
                    </div>
                    <div class="form-group">
                        <label for="PatientBirthday">æ‚£è€…ç”Ÿæ—¥ :</label>
                        <input
                                id="PatientBirthday"
                                name="patientBirthday"
                                type="date"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…ç”Ÿæ—¥"
                                required
                        />
                    </div>

                    <div class="form-group">
                        <label for="PatientGender">æ‚£è€…æ€§åˆ¥ :</label>
                        <select
                                id="PatientGender"
                                class="form-select form-control"
                                name="patientGender"
                                required
                        >
                            <option value="1">ç”·</option>
                            <option value="2">å¥³</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="PatientPhone">æ‚£è€…é›»è©± :</label>
                        <input
                                id="PatientPhone"
                                name="patientPhone"
                                type="tel"
                                class="form-control"
                                maxlength="10"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…é›»è©±"
                        />
                    </div>

                    <div class="form-group">
                        <label for="PatientAddress">æ‚£è€…åœ°å€ :</label>
                        <input
                                id="PatientAddress"
                                name="patientAddress"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…åœ°å€"
                        />
                    </div>

                    <div class="form-group">
                        <label for="PatientEmail">æ‚£è€…ä¿¡ç®± :</label>
                        <input
                                id="PatientEmail"
                                name="patientEmail"
                                type="email"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…ä¿¡ç®±"
                        />
                    </div>


                    <div
                            class="card-action"
                            style="display: flex; justify-content: center"
                    >
                        <!--                        <button-->
                        <!--                                type="button"-->
                        <!--                                id="CancelBtn"-->
                        <!--                                class="btn btn-danger mt-2 me-4"-->
                        <!--                        >-->
                        <!--                            å–æ¶ˆæ–°å¢-->
                        <!--                        </button>-->
                        <button
                                type="submit"
                                id="upConfirmBtn"
                                class="btn btn-success mt-2"
                                style="margin-right: 20px"
                        >
                            æ–°å¢æ‚£è€…
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--MOdal2ä¿®æ”¹è¨‚å–® -->
<div id="upPatientModal" class="modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #1d3d5e">
                <h5 class="modal-title text-light">ä¿®æ”¹è³‡æ–™</h5>
                <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                ></button>
            </div>
            <div class="modal-body">
                <form
                        id="upPatientForm"
                >
                    <input type="hidden" name="action" value="update"/>

                    <div class="form-group">
                        <label for="patientNumber">æ‚£è€…ç·¨è™Ÿ :</label>
                        <input
                                id="upPatientNumber"
                                name="patientNumber"
                                type="text"
                                class="form-control bg-secondary text-white"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…ç·¨è™Ÿ"
                                th:readonly="true"
                        />
                    </div>

                    <div class="form-group">
                        <label for="patientName">æ‚£è€…åç¨± :</label>
                        <input
                                id="upPatientName"
                                name="patientName"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…å§“å"
                        />
                    </div>
                    <div class="form-group">
                        <label for="PatientIdCard">èº«åˆ†è­‰è™Ÿç¢¼ :</label>
                        <input
                                id="upPatientIdCard"
                                name="idCard"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥èº«åˆ†è­‰è™Ÿç¢¼"
                                required
                        />
                    </div>
                    <div class="form-group">
                        <label for="pateintAge">æ‚£è€…ç”Ÿæ—¥ :</label>
                        <input
                                id="upPatientBirthday"
                                name="pateintAge"
                                type="date"
                                class="form-control"
                                min="1"
                                max="100"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…ç”Ÿæ—¥"
                        />
                    </div>

                    <div class="form-group">
                        <label for="patientGender">æ‚£è€…æ€§åˆ¥ :</label>
                        <select
                                id="upPatientGender"
                                class="form-select form-control"
                                name="patientGender"
                        >
                            <option value="1">ç”·</option>
                            <option value="2">å¥³</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="patientPhone">æ‚£è€…é›»è©± :</label>
                        <input
                                id="upPatientPhone"
                                name="patientPhone"
                                type="tel"
                                class="form-control"
                                maxlength="10"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…é›»è©±"
                        />
                    </div>

                    <div class="form-group">
                        <label for="patientAddress">æ‚£è€…åœ°å€ :</label>
                        <input
                                id="upPatientAddress"
                                name="patientAddress"
                                type="text"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…åœ°å€"
                        />
                    </div>

                    <div class="form-group">
                        <label for="patientEmail">æ‚£è€…ä¿¡ç®± :</label>
                        <input
                                id="upPatientEmail"
                                name="patientEmail"
                                type="email"
                                class="form-control"
                                placeholder="è«‹è¼¸å…¥æ‚£è€…ä¿¡ç®±"
                        />
                    </div>


                    <div
                            class="card-action"
                            style="display: flex; justify-content: center"
                    >
                        <button
                                type="submit"
                                id="upConfirmBtn"
                                class="btn btn-success mt-2"
                                style="margin-right: 20px"
                        >
                            ä¿®æ”¹è³‡æ–™
                        </button>
                        <button type="button" class="btn btn-danger btn-delete mt-2"
                                id="deletePatientBtn"
                        >
                            åˆªé™¤è³‡æ–™
                        </button>
                        <!--                        <button-->
                        <!--                                type="button"-->
                        <!--                                id="upCancelBtn"-->
                        <!--                                class="btn btn-danger mt-2"-->
                        <!--                        >-->
                        <!--                            å–æ¶ˆä¿®æ”¹-->
                        <!--                        </button>-->
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--===========================================ä¸‹é¢æ˜¯æˆ‘çš„åŠŸèƒ½=====================================-->

<script>
    // $(function(){
    //==============================================Page=================================
    $(document).ready(function () {

        //ä¸€é–‹å§‹å‚³pageçµ¦å¾Œç«¯ -> å¾0é–‹å§‹
        let currentPage = 0;
        const pageSize = 10;
        //å„²å­˜æœå°‹æ¢ä»¶ é¿å…æœå°‹å¾Œä½¿ç”¨åˆ†é åŠŸèƒ½æ™‚ç™¼ç”ŸéŒ¯èª¤ !!
        let searchParams = null;


        //%%%%%% è·Ÿå¾Œç«¯å–å¾—è³‡æ–™ => å†å‘¼å« 1.è¡¨å–®è³‡æ–™å¸«ç”Ÿæˆ & 2.é é¢æ§åˆ¶çš„ function %%%%%%
        function loadPatients(page) {
            let url = 'findPatientsByPage';
            let params = {page: page, size: pageSize};

            //å¦‚æœå­˜åœ¨æœå°‹æ¢ä»¶ => æ ¹æ“šæœå•¥å¾—åˆ°å•¥
            if (searchParams) {
                // if (searchParams.startDate || searchParams.endDate) {
                    // url = 'findOrdersByDateRange';
                // } else {
                    url = 'findPatientsBySerach';
                // }
                params = {...params, ...searchParams};
            }


            // axios.get(`findOrdersByPage?page=${page}&size=${pageSize}`)
            //æ ¹æ“šä¸åŒæœå°‹æ¢ä»¶å›å‚³ä¸åŒçš„çµæœ
            axios.get(url, {params: params})
                .then(response => {
                    const data = response.data;
                    TableHTML(data.content);
                    Pagination(data);
                })
                .catch(error => console.error('è¦ª!æ²’æœ‰æ‹¿åˆ°è³‡æ–™å–” QQ', error));
        }

        //åˆ†é çš„æ§åˆ¶
        function Pagination(pageData) {
            const $pagination = $('#pagination');
            const $prevPage = $('#prevPage');
            const $nextPage = $('#nextPage');

            currentPage = pageData.number;
            const totalPages = pageData.totalPages;

            // æ¸…é™¤ç¾æœ‰çš„é ç¢¼æŒ‰éˆ•
            //é™¤äº† prevPage è·Ÿ nextPage ä»¥å¤–çš„
            $pagination.find('li.page-item:not(#prevPage):not(#nextPage)').remove();

            // æ›´æ–°ä¸Šä¸€é æŒ‰éˆ•
            if (pageData.first) {
                $prevPage.addClass('disabled');
            } else {
                $prevPage.removeClass('disabled');
            }
            // æ›´æ–°ä¸‹ä¸€é æŒ‰éˆ•
            // å¦‚æœæ˜¯æœ€å¾Œä¸€é æˆ–ç¸½é æ•¸å°æ–¼ç­‰æ–¼1ï¼Œç¦ç”¨ä¸‹ä¸€é 
            if (pageData.last || totalPages <= 1) {
                $nextPage.addClass('disabled');
            } else {
                $nextPage.removeClass('disabled');
            }

            // æ ¹æ“šç¸½é æ•¸ç”ŸæˆæŒ‰éˆ•
            if (totalPages > 1) {
                const start = Math.max(0, currentPage - 2);
                const end = Math.min(totalPages - 1, currentPage + 2);

                for (let i = start; i <= end; i++) {
                    const $pageItem = $('<li>').addClass('page-item');
                    const $pageLink = $('<a>').addClass('page-link').attr('href', '#').text(i + 1);

                    if (i === currentPage) {
                        $pageItem.addClass('active');
                    }

                    $pageLink.on('click', (e) => {
                        e.preventDefault();

                        loadPatients(i);

                    });

                    $pageItem.append($pageLink);
                    $nextPage.before($pageItem);
                }
            }
            // æ›´æ–°é é¢ä¿¡æ¯
            let pageInfoNow = currentPage + 1;

            // $('#pageInfoNow').val(pageInfoNow);
            // $('#totalPageInfo').text(`å…± ${totalPages} é `)
            // $('#pageInfo').text(`ç¬¬ ${pageInfoNow} é ï¼Œå…± ${totalPages} é `);
            $('#pageInfo').text(`ç¬¬ ${currentPage + 1} é ï¼Œå…± ${totalPages} é `);
        }

        //æ”¾åœ¨åˆå§‹åŒ–ç‰©ä»¶å¾Œ ->  currentPage
        // ä¸€é–‹å§‹è¼‰å…¥è¡¨æ ¼è³‡æ–™
        loadPatients(currentPage);

// ç¶å®šä¸Šä¸€é å’Œä¸‹ä¸€é çš„é»æ“Šäº‹ä»¶
        $('#prevPage').on('click', function (e) {
            e.preventDefault();
            if (!$(this).hasClass('disabled')) {
                loadPatients(currentPage - 1);
            }
        });

        $('#nextPage').on('click', function (e) {
            e.preventDefault();
            if (!$(this).hasClass('disabled')) {
                loadPatients(currentPage + 1);
            }
        });


        //è¡¨æ ¼ç”¢ç”Ÿè³‡æ–™çš„ function
        function TableHTML(patients) {
            let html = "";
            patients.forEach((patient) => {
                //å¯è®“ç”Ÿæˆæ™‚ä¾ç…§ç‹€æ…‹è®Šè‰² ğŸ˜
                // const ThreapyColor = patient.threapyStatus == 1 ? "color:green" : "color:red";
                // const PayColor = patient.payStatus == 1 ? "color:green" : "color:red";
                // const btnDisplay = patient.payStatus == 1 ?"display:none":"";

                html += `<tr>
                <td class="border text-center">${patient.patientId}</td>
                <td class="border text-center">${patient.patientName}</td>
                <td class="border text-center">${patient.patientIdCard}</td>
                <td class="border text-center">${patient.patientBirthday}</td>
                <td class="border text-center">${patient.patientGender === 1 ? 'ç”·' : 'å¥³'}</td>
                <td class="border text-center">${patient.patientPhone}</td>
                <td class="border text-center">${patient.patientAddress}</td>
                <td class="border text-center">${patient.patientEmail}</td>
                <td class="border  text-center">
                  <button class="btnAdd btn-update" data-patient='${JSON.stringify(patient)}'><i class="fa-solid fa-wrench">ç·¨è¼¯è³‡æ–™</i></button>
                </td>
                </tr>`;
            });
            $("#patientTbody").html(html);
        }


        // $(document).ready(function () {
        //ä¿®æ”¹è¨‚å–®
        $(document).on("click", ".btn-update", function () {
            let patient = $(this).data("patient");
            let patientNumber = $('#upPatientNumber').val();

            $("#upPatientModal").modal("show");
            //çµ¦é è¨­å€¼
            $("#upPatientNumber").val(patient.patientId);
            $('#upPatientIdCard').val(patient.patientIdCard)
            $("#upPatientName").val(patient.patientName);
            $("#upPatientBirthday").val(patient.patientBirthday);
            $("#upPatientGender").val(patient.patientGender);
            $("#upPatientPhone").val(patient.patientPhone);
            $("#upPatientAddress").val(patient.patientAddress);
            $("#upPatientEmail").val(patient.patientEmail);

            //å–æ¶ˆé‡è¤‡ç¶å®š
            $("#upPatientForm").off("submit");
            //æäº¤ä¿®æ”¹è¡¨å–®
            // ç„¶å¾Œç¶å®šæ–°çš„ submit äº‹ä»¶è™•ç†ç¨‹åº
            $("#upPatientForm").on("submit", function (e) {
                let patientNumber = $('#upPatientNumber').val();
                let upformData = {
                    patientId: $('#upPatientNumber').val(),
                    patientName: $('#upPatientName').val(),
                    patientIdCard: $('#upPatientIdCard').val(),
                    patientBirthday: $('#upPatientBirthday').val(),
                    patientGender: $('#upPatientGender').val(),
                    patientPhone: $('#upPatientPhone').val(),
                    patientAddress: $('#upPatientAddress').val(),
                    patientEmail: $('#upPatientEmail').val(),
                };

                e.preventDefault();
                swal({
                    title: "ç¢ºå®šè¦ä¿®æ”¹å—ï¼Ÿ",
                    text: "",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            axios.put(`/clinic/api/patients/${patientNumber}`, upformData)
                                .then(function (response) {
                                    $("#upPatientModal").modal("hide");
                                    loadPatients(currentPage);
                                    swal({
                                        title: "ä¿®æ”¹æˆåŠŸ",
                                        icon: "success",
                                    });
                                })
                                .catch(function (error) {
                                    console.log("ä¿®æ”¹å¤±æ•—", error);
                                    swal({
                                        title: "ä¿®æ”¹å¤±æ•—,ç™¼ç”ŸéŒ¯èª¤!",
                                        text: "",
                                        icon: "error",
                                        buttons: true,
                                        dangerMode: true,
                                    })
                                    // alert("ä¿®æ”¹å¤±æ•—ï¼Œç™¼ç”ŸéŒ¯èª¤");
                                })

                        } else {
                            swal({
                                title: "å–æ¶ˆä¿®æ”¹",
                            });
                        }
                    });
                // if (confirm("ç¢ºå®šè¦ä¿®æ”¹å—ï¼Ÿ")) {
                //     axios.put(`/clinic/api/patients/${patientNumber}`, upformData)
                //         .then(function (response) {
                //             alert("ä¿®æ”¹æˆåŠŸ");
                //             $("#upPatientModal").modal("hide");
                //             loadPatients(currentPage);
                //         })
                //         .catch(function (error) {
                //             console.log("ä¿®æ”¹å¤±æ•—", error);
                //             alert("ä¿®æ”¹å¤±æ•—ï¼Œç™¼ç”ŸéŒ¯èª¤");
                //         })
                //     // this.submit();
                // } else {
                //     alert("å–æ¶ˆä¿®æ”¹");
                // }
            });
            // ç¶å®šåˆªé™¤è¨‚å–®çš„é»æ“Šäº‹ä»¶
            $("#deletePatientBtn").off("click").on("click", function () {
                swal({
                    title: "ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ",
                    text: "ä¸€æ—¦åˆªé™¤ï¼Œè³‡æ–™ç„¡æ³•å¾©åŸ!",
                    icon: "warning",
                    buttons: true,
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            let patientNumber = $('#upPatientNumber').val();
                            axios.delete(`/clinic/api/patients/${patientNumber}`)
                                .then(function (response) {
                                    $('#upPatientModal').modal('hide');
                                    loadPatients(currentPage);
                                    swal({
                                        title: "åˆªé™¤æˆåŠŸ",
                                        icon: "success",
                                    });
                                })
                                .catch(function (error) {
                                    console.log('ErroréŒ¯ç‰©', error);
                                    swal({
                                        title: "åˆªé™¤å¤±æ•—,ç™¼ç”ŸéŒ¯èª¤!",
                                        text: "",
                                        icon: "error",
                                        buttons: true,
                                        dangerMode: true,
                                    })
                                })
                        } else {
                            swal({
                                title: "å–æ¶ˆåˆªé™¤",
                            });
                        }
                    });
            });
            //é»æ“Šå–æ¶ˆmodalæ¶ˆå¤±
            // $("#upCancelBtn").on("click", function () {
            //     $("#upOrderModal").modal("hide");
            // });
        });
        //æ–°å¢æ‚£è€…æŒ‰éˆ•
        $('body').on("click", "#addBtn", function () {

            $("#addPatientModal").modal("show");

            //å¯èƒ½æœƒè·³é‡è¤‡ç¶å®šäº‹ä»¶çš„éŒ¯èª¤
            $("#PatientForm").off("submit");
            //æäº¤è¡¨å–®
            $("#PatientForm").on("submit", function (e) {
                e.preventDefault();

                swal({
                    title: "ç¢ºå®šè¦æ–°å¢å—ï¼Ÿ",
                    text: "",
                    icon: "info",
                    buttons: true,
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            let formData = {
                                patientId: '',
                                patientName: $('#PatientName').val(),
                                patientIdCard: $('#PatientIdCard').val(),
                                patientBirthday: $('#PatientBirthday').val(),
                                patientGender: $('#PatientGender').val(),
                                patientPhone: $('#PatientPhone').val(),
                                patientAddress: $('#PatientAddress').val(),
                                patientEmail: $('#PatientEmail').val(),
                            };
                            axios.post('/clinic/api/patients', formData)
                                .then(function (response) {
                                    $("#addPatientModal").modal("hide");
                                    // alert("æ–°å¢æˆåŠŸ");
                                    loadPatients(currentPage);
                                    swal({
                                        title: "æ–°å¢æˆåŠŸ!",
                                        icon: "success",
                                    });
                                })
                                .catch(function (error) {
                                    console.log("ErroréŒ¯èª¤ç™¼ç”Ÿ", error);
                                    swal({
                                        title: "æ–°å¢å¤±æ•—,ç™¼ç”ŸéŒ¯èª¤!",
                                        text: "",
                                        icon: "error",
                                        buttons: true,
                                        dangerMode: true,
                                    })
                                    // alert("æ–°å¢å¤±æ•—,ç™¼ç”ŸéŒ¯èª¤!")
                                })
                        } else {
                            swal({
                                title: "å–æ¶ˆæ–°å¢!",
                            });
                        }
                    });

                // //é»æ“Šå–æ¶ˆmodalæ¶ˆå¤±
                // $("#CancelBtn").on("click", function () {
                //     $("#addPatientModal").modal("hide");
                // });


            });
        })
        // < !--ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½-- >
        // < !--ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½-- >
        // < !--ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½-- >

        // æœå°‹é¸å–®å­—é«”æ”¹è®Š
        let SearchType;
        $(".choose").on("click", function () {
            let BtnText = $(this).text();
            $("#dropdownMenuButton1").text(BtnText);
            SearchType = $(this).data('searchtype');
        });
        // å–®é …æœå°‹åŠŸèƒ½
        // å–®é …æœå°‹åŠŸèƒ½
        $('#SearchBtn').on('click', function () {
            let input = $('#Search').val().trim();
            // let
            // if (!SearchType) {
            //     alert("è¼¸å…¥æœå°‹æ¢ä»¶ ğŸ˜’ğŸ˜’")
            //     return;
            // }
            // æ¯æ¬¡æœå°‹é‡ç½® !!!
            // æ¯æ¬¡æœå°‹é‡ç½® !!!
            // æ¯æ¬¡æœå°‹é‡ç½® !!!
            currentPage = 0;
            searchParams = {["patientName"]: input};
            loadPatients(currentPage);
        })
    })
</script>
<script>
    // ä¸€éµå¸¶å…¥
    $("#addVal").on("click", function () {
        // å¸¶å…¥çš„å€¼
        let testData = {
            name: "ç‹å°æ˜",
            idCard: 'N123456789',
            birthday: '1989-02-03',
            gender: "1",
            phone: "0912345678",
            address: "å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ",
            email: "testWong1989@gmail.com",
        };
        //å¸¶å…¥å€¼
        $("#PatientName").val(testData.name);
        $("#PatientIdCard").val(testData.idCard);
        $("#PatientBirthday").val((testData.birthday));
        $("#PatientGender").val(testData.gender);
        $("#PatientPhone").val(testData.phone);
        $("#PatientAddress").val(testData.address);
        $("#PatientEmail").val(testData.email);

    });

</script>

<!--<script>-->
<!--    // < !&#45;&#45;ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½&#45;&#45; >-->
<!--    // < !&#45;&#45;ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½&#45;&#45; >-->
<!--    // < !&#45;&#45;ä¸‹æ‹‰é¸å–®çš„js & æœå°‹çš„åŠŸèƒ½&#45;&#45; >-->

<!--    // æœå°‹é¸å–®å­—é«”æ”¹è®Š-->
<!--    let SearchType;-->
<!--    $(".choose").on("click", function () {-->
<!--        let BtnText = $(this).text();-->
<!--        $("#dropdownMenuButton1").text(BtnText);-->
<!--        SearchType = $(this).data('searchtype');-->
<!--    });-->
<!--    // å–®é …æœå°‹åŠŸèƒ½-->
<!--    // å–®é …æœå°‹åŠŸèƒ½-->
<!--    $('#SearchBtn').on('click', function () {-->
<!--        let input = $('#Search').val().trim();-->

<!--        // if (!SearchType) {-->
<!--        //     alert("è¼¸å…¥æœå°‹æ¢ä»¶ ğŸ˜’ğŸ˜’")-->
<!--        //     return;-->
<!--        // }-->
<!--        // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--        // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--        // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--        currentPage = 0;-->
<!--        searchParams = {[SearchType]: input};-->
<!--        (currentPage);-->
<!--    })-->
<!--    // // ç¶å®šç™‚ç¨‹é€²åº¦æœå°‹æŒ‰éˆ•-->
<!--    // $('#SearchByStatusBtn').on('click', function () {-->
<!--    //     let threapyStatus = $('#threapyStatus').val(); // ç™‚ç¨‹é€²åº¦-->
<!--    //     currentPage = 0;-->
<!--    //     searchParams = {threapyStatus: threapyStatus}; // è¨­ç½®æœå°‹æ¢ä»¶-->
<!--    //     loadOrders(currentPage);-->
<!--    // });-->
<!--    // // ç¶å®šä»˜æ¬¾ç‹€æ…‹æœå°‹æŒ‰éˆ•-->
<!--    // $('#SearchByStatusBtn2').on('click', function () {-->
<!--    //     let payStatus = $('#payStatus').val(); // ä»˜æ¬¾ç‹€æ…‹-->
<!--    //     currentPage = 0;-->
<!--    //     searchParams = {payStatus: payStatus}; // è¨­ç½®æœå°‹æ¢ä»¶-->
<!--    //     loadOrders(currentPage);-->
<!--    // });-->
<!--    //-->
<!--    // // æ—¥æœŸå€é–“æœå°‹åŠŸèƒ½-->
<!--    // // æ—¥æœŸå€é–“æœå°‹åŠŸèƒ½-->
<!--    // $('#SearchBtn2').on('click', function () {-->
<!--    //     let startDate = $('#startDate').val();-->
<!--    //     let endDate = $('#endDate').val();-->
<!--    //-->
<!--    //     //å…©å€‹éƒ½è¦é¸æ“‡-->
<!--    //     if (!startDate || !endDate) {-->
<!--    //         alert("è«‹é¸æ“‡å®Œæ•´çš„æ—¥æœŸå€é–“");-->
<!--    //         return;-->
<!--    //     }-->
<!--    //     // ç¢ºä¿çµæŸæ—¥æœŸä¸æ—©æ–¼é–‹å§‹æ—¥æœŸ â¤ï¸-->
<!--    //     if (new Date(endDate) < new Date(startDate)) {-->
<!--    //         alert("çµæŸæ—¥æœŸä¸èƒ½æ—©æ–¼é–‹å§‹æ—¥æœŸ!!!");-->
<!--    //         return;-->
<!--    //     }-->
<!--    //     // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--    //     // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--    //     // æ¯æ¬¡æœå°‹é‡ç½® !!!-->
<!--    //     currentPage = 0;-->
<!--    //     searchParams = {startDate: startDate, endDate: endDate};-->
<!--    //     loadOrders(currentPage);-->
<!--    // });-->

<!--</script>-->
</body>
</html>
